<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="edcInsttMngr">

<typeAlias alias="edcInsttMngrVO" type="kr.co.hanshinit.NeoEdu.cop.edcInsttMngr.service.EdcInsttMngrVO" />
<typeAlias alias="edcInsttMngr" type="kr.co.hanshinit.NeoEdu.cop.edcInsttMngr.service.EdcInsttMngr" />

<resultMap id="edcInsttMngrHashMap" class="java.util.HashMap">
	<result property="insttCode" column="INSTT_CODE"/>									<!-- 기관코드 -->
	<result property="insttNm" column="INSTT_NM"/>											<!-- 기관명 -->
</resultMap>

<resultMap id="edcInsttMngrMap" class="kr.co.hanshinit.NeoEdu.cop.edcInsttMngr.service.EdcInsttMngrVO">
	<result property="insttCode" column="INSTT_CODE"/>															<!-- 기관코드 -->
	<result property="insttNm" column="INSTT_NM"/>																	<!-- 기관명 -->
	<result property="insttDstrct" column="INSTT_DSTRCT"/>													<!-- 기관단위 -->
	<result property="insttZip" column="INSTT_ZIP"/>																	<!-- 우편번호 -->
	<result property="insttAdres" column="INSTT_ADRES"/>														<!-- 기관 주소01 -->
	<result property="insttAdresDetail" column="INSTT_ADRES_DETAIL"/>							<!-- 기관주소02 -->
	<result property="tel01" column="TEL01"/>																				<!-- 대표전화번호 01 -->
	<result property="telAdit" column="TEL_ADIT"/>																		<!-- 대표전화번호 추가 -->
	<result property="fax01" column="FAX01"/>																			<!-- 대표 팩스번호 01 -->
	<result property="faxAdit" column="FAX_ADIT"/>																	<!-- 대표 팩스번호 추가 -->
	<result property="dstrctCl" column="DSTRCT_CL"/>																<!-- 권역분류 -->
	<result property="insLocalCd" column="INS_LOCAL_CD"/>													<!-- 지역명-시 -->
	<result property="chargerId" column="CHARGER_ID"/>														<!-- 담당자 아이디 -->
	<result property="chargerNm" column="CHARGER_NM"/>													<!-- 담당지 이름 -->
	<result property="chargerEmail" column="CHARGER_EMAIL"/>											<!-- 담당자 이메일 -->
	<result property="confmAt" column="CONFM_AT"/>															<!-- 승인여부 -->
	<result property="confmDe" column="CONFM_DE"/>															<!-- 승인일자 -->
	<result property="confmId" column="CONFM_ID"/>																<!-- 승인자 아이디 -->
	<result property="elctrnSanctnId" column="ELCTRN_SANCTN_ID"/>									<!-- 전자결재아이디 -->
	<result property="insttRprsntvNm" column="INSTT_RPRSNTV_NM"/>								<!-- 기관대표자 -->
	<result property="gpsLa" column="GPS_LA"/>																			<!-- GPS_위도 -->
	<result property="gpsLo" column="GPS_LO"/>																			<!-- GPS_경도 -->
	<result property="opnngDe" column="OPNNG_DE"/>															<!-- 창립기념일 -->
	<result property="useAt" column="USE_AT"/>																			<!-- 사용유무 -->
	<result property="deleteAt" column="DELETE_AT"/>																<!-- 삭제유무 -->
	<result property="insttLclas" column="INSTT_LCLAS"/>															<!-- 기관구분-대분류 -->
	<result property="insttMlsfc" column="INSTT_MLSFC"/>														<!-- 기관구분-중분류 -->
	<result property="insttSclas" column="INSTT_SCLAS"/>															<!-- 기관구분-소분류 -->
	<result property="frstRegisterPnttm" column="FRST_REGISTER_PNTTM"/>						<!-- 최초등록일시 -->
	<result property="frstRegisterId" column="FRST_REGISTER_ID"/>										<!-- 최초등록자ID -->
	<result property="frstRegisterIp" column="FRST_REGISTER_IP"/>										<!-- 최초등록자IP -->
	<result property="lastUpdusrPnttm" column="LAST_UPDUSR_PNTTM"/>						<!-- 최종수정시점 -->
	<result property="lastUpdusrId" column="LAST_UPDUSR_ID"/>											<!-- 최종수정자ID -->
	<result property="lastUpdusrIp" column="LAST_UPDUSR_IP"/>											<!-- 최종수정자IP -->
	<result property="insParentYn" column="INS_PARENT_YN"/>												<!-- 학부모지원센터지정기관 여부 -->
	<result property="insAllYn" column="INS_ALL_YN"/>																<!-- 평생학습계좌제평가 인정 여부 -->
	<result property="insCbYn" column="INS_CB_YN"/>																<!-- 학점은행제평가인정기관 여부 -->
	<result property="insHrdYn" column="INS_HRD_YN"/>															<!-- 직업능력개발훈력기관 여부 -->
	<result property="insLlCd" column="INS_LL_CD"/>																	<!-- 평생학습관 지정여부 -->
	<result property="insLocalYn" column="INS_LOCAL_YN"/>													<!-- 지역평생교육정보센터 지정 여부 -->
	<result property="insStatusCd" column="INS_STATUS_CD"/>												<!-- 기관 운영상태 -->
	<result property="insFormDivCd" column="INS_FORM_DIV_CD"/>									<!-- 기관 운영형태 -->
	<result property="insFoundDivCd" column="INS_FOUND_DIV_CD"/>								<!-- 기관 설립주체 -->
	<result property="netInfo" column="NET_INFO"/>																	<!-- 외부연동시스템 코드 (예: NILE) -->
	<result property="gilInsCd" column="GIL_INS_CD"/>																<!-- 경기평생학습포털 기관코드 -->
	<result property="insLocal2Cd" column="INS_LOCAL2_CD"/>												<!-- 지역-구,읍,면,동 -->
	<result property="webUrl" column="WEB_URL"/>																	<!-- 웹 URL -->
	<result property="insttGuidance" column="INSTT_GUIDANCE"/>										<!-- 기관 소개 -->
	<result property="sortNo" column="SORT_NO"/>																	<!-- 정렬 순서 -->
	<result property="decBeginBndeSmsYn" column="DEC_BEGIN_BNDE_SMS_YN"/>		<!-- 교육 시작전 문자발송 유무 -->
	<result property="siteNum" column="SITE_NUM"/>																<!-- 결제 연동 코드 -->
</resultMap>

<insert id="edcInsttMngrDAO.insertEdcInsttMngr" parameterClass="edcInsttMngrVO">
		<selectKey keyProperty="insttCode" resultClass="Integer">
			SELECT IFNULL(MAX(INSTT_CODE)+1,1) AS CNT FROM TN_EDC_INSTT_MNGR
		</selectKey>
		INSERT INTO TN_EDC_INSTT_MNGR (
			INSTT_CODE,
			INSTT_NM,
			INSTT_DSTRCT,
			INSTT_ZIP,
			INSTT_ADRES,
			INSTT_ADRES_DETAIL,
			TEL01,
			TEL_ADIT,
			FAX01,
			FAX_ADIT,
			DSTRCT_CL,
			INS_LOCAL_CD,
			CHARGER_ID,
			CHARGER_NM,
			CHARGER_EMAIL,
			CONFM_AT,
			CONFM_DE,
			CONFM_ID,
			ELCTRN_SANCTN_ID,
			INSTT_RPRSNTV_NM,
			GPS_LA,
			GPS_LO,
			OPNNG_DE,
			USE_AT,
			DELETE_AT,
			INSTT_LCLAS,
			INSTT_MLSFC,
			INSTT_SCLAS,
			FRST_REGISTER_PNTTM,
			FRST_REGISTER_ID,
			FRST_REGISTER_IP,
			LAST_UPDUSR_PNTTM,
			LAST_UPDUSR_ID,
			LAST_UPDUSR_IP,
			INS_PARENT_YN,
			INS_ALL_YN,
			INS_CB_YN,
			INS_HRD_YN,
			INS_LL_CD,
			INS_LOCAL_YN,
			INS_STATUS_CD,
			INS_FORM_DIV_CD,
			INS_FOUND_DIV_CD,
			NET_INFO,
			GIL_INS_CD,
			INS_LOCAL2_CD,
			WEB_URL,
			INSTT_GUIDANCE,
			SORT_NO,
			DEC_BEGIN_BNDE_SMS_YN,
			SITE_NUM
		)
		VALUES (
			#insttCode#,
			#insttNm#,
			#insttDstrct#,
			#insttZip#,
			#insttAdres#,
			#insttAdresDetail#,
			#tel01#,
			#telAdit#,
			#fax01#,
			#faxAdit#,
			#dstrctCl#,
			#insLocalCd#,
			#chargerId#,
			#chargerNm#,
			#chargerEmail#,
			#confmAt#,
			#confmDe#,
			#confmId#,
			#elctrnSanctnId#,
			#insttRprsntvNm#,
			#gpsLa#,
			#gpsLo#,
			#opnngDe#,
			#useAt#,
			#deleteAt#,
			#insttLclas#,
			#insttMlsfc#,
			#insttSclas#,
			#frstRegisterPnttm#,
			#frstRegisterId#,
			#frstRegisterIp#,
			#lastUpdusrPnttm#,
			#lastUpdusrId#,
			#lastUpdusrIp#,
			#insParentYn#,
			#insAllYn#,
			#insCbYn#,
			#insHrdYn#,
			#insLlCd#,
			#insLocalYn#,
			#insStatusCd#,
			#insFormDivCd#,
			#insFoundDivCd#,
			#netInfo#,
			#gilInsCd#,
			#insLocal2Cd#,
			#webUrl#,
			#insttGuidance#,
			(SELECT IFNULL(MAX(A.SORT_NO), 1) + 1 AS SORT_NO FROM TN_EDC_INSTT_MNGR A) ,
			#decBeginBndeSmsYn#,
			#siteNum#
		)
</insert>

<update id="edcInsttMngrDAO.updateEdcInsttMngr" parameterClass="edcInsttMngrVO">
		UPDATE TN_EDC_INSTT_MNGR
		<dynamic prepend="SET" >
				<isNotEmpty prepend=","  property="insttNm" >
					INSTT_NM = #insttNm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttDstrct" >
					INSTT_DSTRCT = #insttDstrct#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttZip" >
					INSTT_ZIP = #insttZip#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttAdres" >
					INSTT_ADRES = #insttAdres#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttAdresDetail" >
					INSTT_ADRES_DETAIL = #insttAdresDetail#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="tel01" >
					TEL01 = #tel01#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="telAdit" >
					TEL_ADIT = #telAdit#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="fax01" >
					FAX01 = #fax01#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="faxAdit" >
					FAX_ADIT = #faxAdit#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="dstrctCl" >
					DSTRCT_CL = #dstrctCl#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLocalCd" >
					INS_LOCAL_CD = #insLocalCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="chargerId" >
					CHARGER_ID = #chargerId#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="chargerNm" >
					CHARGER_NM = #chargerNm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="chargerEmail" >
					CHARGER_EMAIL = #chargerEmail#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="confmAt" >
					CONFM_AT = #confmAt#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="confmDe" >
					CONFM_DE = #confmDe#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="confmId" >
					CONFM_ID = #confmId#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="elctrnSanctnId" >
					ELCTRN_SANCTN_ID = #elctrnSanctnId#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttRprsntvNm" >
					INSTT_RPRSNTV_NM = #insttRprsntvNm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="gpsLa" >
					GPS_LA = #gpsLa#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="gpsLo" >
					GPS_LO = #gpsLo#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="useAt" >
					USE_AT = #useAt#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="deleteAt" >
					DELETE_AT = #deleteAt#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttLclas" >
					INSTT_LCLAS = #insttLclas#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttMlsfc" >
					INSTT_MLSFC = #insttMlsfc#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttSclas" >
					INSTT_SCLAS = #insttSclas#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="frstRegisterPnttm" >
					FRST_REGISTER_PNTTM = #frstRegisterPnttm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="frstRegisterId" >
					FRST_REGISTER_ID = #frstRegisterId#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="frstRegisterIp" >
					FRST_REGISTER_IP = #frstRegisterIp#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="lastUpdusrPnttm" >
					LAST_UPDUSR_PNTTM = #lastUpdusrPnttm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="lastUpdusrId" >
					LAST_UPDUSR_ID = #lastUpdusrId#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="lastUpdusrIp" >
					LAST_UPDUSR_IP = #lastUpdusrIp#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insParentYn" >
					INS_PARENT_YN = #insParentYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insAllYn" >
					INS_ALL_YN = #insAllYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insCbYn" >
					INS_CB_YN = #insCbYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insHrdYn" >
					INS_HRD_YN = #insHrdYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLlCd" >
					INS_LL_CD = #insLlCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLocalYn" >
					INS_LOCAL_YN = #insLocalYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insStatusCd" >
					INS_STATUS_CD = #insStatusCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insFormDivCd" >
					INS_FORM_DIV_CD = #insFormDivCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insFoundDivCd" >
					INS_FOUND_DIV_CD = #insFoundDivCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="netInfo" >
					NET_INFO = #netInfo#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="gilInsCd" >
					GIL_INS_CD = #gilInsCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLocal2Cd" >
					INS_LOCAL2_CD = #insLocal2Cd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="webUrl" >
					WEB_URL = #webUrl#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttGuidance" >
					INSTT_GUIDANCE = #insttGuidance#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="siteNum" >
					SITE_NUM = #siteNum#
				</isNotEmpty>
		</dynamic>
		WHERE INSTT_CODE = #insttCode#
</update>

<update id="edcInsttMngrDAO.updateInsttMngr" parameterClass="edcInsttMngrVO">
		UPDATE TN_EDC_INSTT_MNGR
		<dynamic prepend="SET" >
				<isNotEmpty prepend=","  property="insttNm" >
					INSTT_NM = #insttNm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttDstrct" >
					INSTT_DSTRCT = #insttDstrct#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttZip" >
					INSTT_ZIP = #insttZip#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttAdres" >
					INSTT_ADRES = #insttAdres#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttAdresDetail" >
					INSTT_ADRES_DETAIL = #insttAdresDetail#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="tel01" >
					TEL01 = #tel01#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttRprsntvNm" >
					INSTT_RPRSNTV_NM = #insttRprsntvNm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="gpsLa" >
					GPS_LA = #gpsLa#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="gpsLo" >
					GPS_LO = #gpsLo#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="useAt" >
					USE_AT = #useAt#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="deleteAt" >
					DELETE_AT = #deleteAt#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="lastUpdusrPnttm" >
					LAST_UPDUSR_PNTTM = #lastUpdusrPnttm#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="lastUpdusrId" >
					LAST_UPDUSR_ID = #lastUpdusrId#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="lastUpdusrIp" >
					LAST_UPDUSR_IP = #lastUpdusrIp#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insParentYn" >
					INS_PARENT_YN = #insParentYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insAllYn" >
					INS_ALL_YN = #insAllYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insCbYn" >
					INS_CB_YN = #insCbYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insHrdYn" >
					INS_HRD_YN = #insHrdYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLlCd" >
					INS_LL_CD = #insLlCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLocalYn" >
					INS_LOCAL_YN = #insLocalYn#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insStatusCd" >
					INS_STATUS_CD = #insStatusCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insFormDivCd" >
					INS_FORM_DIV_CD = #insFormDivCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insFoundDivCd" >
					INS_FOUND_DIV_CD = #insFoundDivCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="netInfo" >
					NET_INFO = #netInfo#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="gilInsCd" >
					GIL_INS_CD = #gilInsCd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insLocal2Cd" >
					INS_LOCAL2_CD = #insLocal2Cd#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="webUrl" >
					WEB_URL = #webUrl#
				</isNotEmpty>
				<isNotEmpty prepend=","  property="insttGuidance" >
					INSTT_GUIDANCE = #insttGuidance#
				</isNotEmpty>
		</dynamic>
		WHERE INSTT_CODE = #insttCode#
</update>

<!-- 사용유무 업데이트  -->
<update id="edcInsttMngrDAO.updateEdcInsttMngrUseAt" parameterClass="edcInsttMngrVO">
		UPDATE TN_EDC_INSTT_MNGR
				SET
						  USE_AT = #useAt#
						, LAST_UPDUSR_PNTTM = #lastUpdusrPnttm#
						, LAST_UPDUSR_ID = #lastUpdusrId#
						, LAST_UPDUSR_IP = #lastUpdusrIp#
		 WHERE INSTT_CODE = #insttCode#
</update>

<!-- 승인여부 업데이트  -->
<update id="edcInsttMngrDAO.updateEdcInsttMngrConfmAt" parameterClass="edcInsttMngrVO">
		UPDATE TN_EDC_INSTT_MNGR
				SET
						  CONFM_AT = #confmAt#
						, CONFM_DE = #confmDe#
						, CONFM_ID = #confmId#
						, LAST_UPDUSR_PNTTM = #lastUpdusrPnttm#
						, LAST_UPDUSR_ID = #lastUpdusrId#
						, LAST_UPDUSR_IP = #lastUpdusrIp#
		 WHERE INSTT_CODE = #insttCode#
</update>


<delete id="edcInsttMngrDAO.deleteEdcInsttMngr" parameterClass="edcInsttMngrVO">
		UPDATE TN_EDC_INSTT_MNGR
				SET
						  USE_AT = #useAt#
						, DELETE_AT = #deleteAt#
						, LAST_UPDUSR_PNTTM = #lastUpdusrPnttm#
						, LAST_UPDUSR_ID = #lastUpdusrId#
						, LAST_UPDUSR_IP = #lastUpdusrIp#
		 WHERE INSTT_CODE = #insttCode#
</delete>

<select id="edcInsttMngrDAO.selectEdcInsttMngrTotCnt" resultClass="Integer" parameterClass="edcInsttMngrVO">
	SELECT
			       COUNT(*) AS TOT_CNT
	  FROM TN_EDC_INSTT_MNGR
	  <dynamic prepend="WHERE" >
	  		<isNotEmpty prepend="AND" property="searchInsttUnit" >
	  			<isNotEqual  property="searchInsttUnit" compareValue="ALL">
	  				INSTT_DSTRCT = #searchInsttUnit#
	  			</isNotEqual>
			</isNotEmpty>
	  		<isNotEmpty prepend="AND" property="searchInsttCode" >
	  			<isNotEqual  property="searchInsttCode" compareValue="ALL">
					INSTT_CODE = #searchInsttCode#
				</isNotEqual>
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="searchInsttNm" >
					INSTT_NM LIKE <![CDATA['%]]>$searchInsttNm$<![CDATA[%']]>
			 </isNotEmpty>
			 <isNotEmpty prepend="AND" property="searchInsttMlsfc" >
					INSTT_MLSFC = #searchInsttMlsfc#
			  </isNotEmpty>
			 <isNotEmpty prepend="AND" property="searchdstrctCl" >
					DSTRCT_CL = #searchdstrctCl#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="searchInsttDstrct" >
						INSTT_DSTRCT = #searchInsttDstrct#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="searchDeleteAt" >
					DELETE_AT = #searchDeleteAt#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="searchUseAt" >
					USE_AT = #searchUseAt#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="searchConfmAt" >
					CONFM_AT = #searchConfmAt#
			   </isNotEmpty>
			   <isNotEmpty prepend="AND" property="searchInsttDstrctIn" >
						INSTT_DSTRCT IN ('EC','ERNT','ETC')
			  		</isNotEmpty>
			   <isNotEmpty prepend="AND" property="authUserId" >
					INSTT_CODE IN (SELECT INSTT_CODE FROM TN_RESVE_INSTT_AUTHOR WHERE USER_ID = #authUserId# AND USE_AT = 'Y' AND DELETE_AT ='N' )
				</isNotEmpty>
		</dynamic>
</select>

<select id="edcInsttMngrDAO.selectEdcInsttMngrList" resultMap="edcInsttMngrMap" parameterClass="edcInsttMngrVO">
SELECT T1.*  FROM (
		SELECT @RNUM := @RNUM + 1 AS ROWNUM, T.* FROM (
				SELECT
					INSTT_CODE,
					INSTT_NM,
					INSTT_DSTRCT,
					INSTT_ZIP,
					INSTT_ADRES,
					INSTT_ADRES_DETAIL,
					TEL01,
					TEL_ADIT,
					FAX01,
					FAX_ADIT,
					DSTRCT_CL,
					INS_LOCAL_CD,
					CHARGER_ID,
					CHARGER_NM,
					CHARGER_EMAIL,
					CONFM_AT,
					CONFM_DE,
					CONFM_ID,
					ELCTRN_SANCTN_ID,
					INSTT_RPRSNTV_NM,
					GPS_LA,
					GPS_LO,
					OPNNG_DE,
					USE_AT,
					DELETE_AT,
					INSTT_LCLAS,
					INSTT_MLSFC,
					INSTT_SCLAS,
					FRST_REGISTER_PNTTM,
					FRST_REGISTER_ID,
					FRST_REGISTER_IP,
					LAST_UPDUSR_PNTTM,
					LAST_UPDUSR_ID,
					LAST_UPDUSR_IP,
					INS_PARENT_YN,
					INS_ALL_YN,
					INS_CB_YN,
					INS_HRD_YN,
					INS_LL_CD,
					INS_LOCAL_YN,
					INS_STATUS_CD,
					INS_FORM_DIV_CD,
					INS_FOUND_DIV_CD,
					NET_INFO,
					GIL_INS_CD,
					INS_LOCAL2_CD,
					WEB_URL,
					INSTT_GUIDANCE,
					IFNULL(SORT_NO, 1) AS SORT_NO,
					DEC_BEGIN_BNDE_SMS_YN,
					IFNULL(SITE_NUM, 0) AS SITE_NUM
				FROM TN_EDC_INSTT_MNGR
				<dynamic prepend="WHERE" >
			  		<isNotEmpty prepend="AND" property="searchInsttUnit" >
			  			<isNotEqual  property="searchInsttUnit" compareValue="ALL">
			  				INSTT_DSTRCT = #searchInsttUnit#
			  			</isNotEqual>
					</isNotEmpty>
			  		<isNotEmpty prepend="AND" property="searchInsttCode" >
			  			<isNotEqual  property="searchInsttCode" compareValue="ALL">
							INSTT_CODE = #searchInsttCode#
						</isNotEqual>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchInsttNm" >
						INSTT_NM LIKE <![CDATA['%]]>$searchInsttNm$<![CDATA[%']]>
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchInsttMlsfc" >
						INSTT_MLSFC = #searchInsttMlsfc#
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchdstrctCl" >
						DSTRCT_CL = #searchdstrctCl#
			  		</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchInsttDstrct" >
						INSTT_DSTRCT = #searchInsttDstrct#
			  		</isNotEmpty>
			  		<isNotEmpty prepend="AND" property="authUserId" >
						<!-- 조회 권한 설정 -->
				   		INSTT_CODE IN (SELECT INSTT_CODE FROM TN_RESVE_INSTT_AUTHOR WHERE USER_ID = #authUserId# AND USE_AT = 'Y' AND DELETE_AT ='N')
				    </isNotEmpty>
				    <isNotEmpty prepend="AND" property="searchDeleteAt" >
						DELETE_AT = #searchDeleteAt#
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchUseAt" >
						USE_AT = #searchUseAt#
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchConfmAt" >
						CONFM_AT = #searchConfmAt#
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="searchInsttDstrctIn" >
						INSTT_DSTRCT IN ('EC','ERNT','ETC')
			  		</isNotEmpty>
				</dynamic>
		) T, (SELECT @RNUM := 0) R
	) T1 ORDER BY SORT_NO, INSTT_NM LIMIT #firstIndex#, #lastIndex#  
</select>

<select id="edcInsttMngrDAO.selectEdcInsttMngrData" resultMap="edcInsttMngrMap" parameterClass="edcInsttMngrVO">
		SELECT
					   INSTT_CODE, INSTT_NM, INSTT_DSTRCT,
					   INSTT_LCLAS, INSTT_MLSFC, INSTT_SCLAS,
					   DSTRCT_CL, INS_LOCAL_CD, INS_LOCAL2_CD,
					   INSTT_ZIP, INSTT_ADRES, INSTT_ADRES_DETAIL,
					   INSTT_GUIDANCE, TEL01, TEL_ADIT,
					   FAX01, FAX_ADIT, CONFM_AT,
					   CONFM_DE, CONFM_ID, CHARGER_ID,
					   CHARGER_NM, ELCTRN_SANCTN_ID, INSTT_RPRSNTV_NM,
					   CHARGER_EMAIL, GPS_LA, GPS_LO,
					   OPNNG_DE, WEB_URL, NET_INFO,
					   INS_ADD_STAMP, INS_LOCAL_YN, INS_LL_CD,
					   INS_HRD_YN, INS_CB_YN, INS_ALL_YN,
					   INS_PARENT_YN, INS_FOUND_DIV_CD, INS_FORM_DIV_CD,
					   INS_STATUS_CD, GIL_INS_CD, USE_AT,
					   DELETE_AT, FRST_REGISTER_PNTTM, FRST_REGISTER_ID,
					   FRST_REGISTER_IP, LAST_UPDUSR_PNTTM, LAST_UPDUSR_ID,
					   LAST_UPDUSR_IP, DEC_BEGIN_BNDE_SMS_YN, RETURN_RESEN,
					   IFNULL(SORT_NO,1) AS SORT_NO, IFNULL(SITE_NUM, 0) AS SITE_NUM
		  FROM
		  				TN_EDC_INSTT_MNGR
		 WHERE INSTT_CODE = #insttCode#
		 <isNotEmpty prepend="AND" property="searchUseAt" >
						USE_AT	= #searchUseAt#
		 </isNotEmpty>
</select>

<insert id="edcInsttMngrDAO.insertEdcInsttMngrListIterator" parameterClass="java.util.List">
	INSERT ALL
<iterate conjunction=" ">
INTO TN_EDC_INSTT_MNGR (
	INSTT_CODE,
	INSTT_NM,
	INSTT_DSTRCT,
	INSTT_ZIP,
	INSTT_ADRES,
	INSTT_ADRES_DETAIL,
	TEL01,
	TEL_ADIT,
	FAX01,
	FAX_ADIT,
	DSTRCT_CL,
	INS_LOCAL_CD,
	CHARGER_ID,
	CHARGER_NM,
	CHARGER_EMAIL,
	CONFM_AT,
	CONFM_DE,
	CONFM_ID,
	ELCTRN_SANCTN_ID,
	INSTT_RPRSNTV_NM,
	GPS_LA,
	GPS_LO,
	USE_AT,
	DELETE_AT,
	INSTT_LCLAS,
	INSTT_MLSFC,
	INSTT_SCLAS,
	FRST_REGISTER_PNTTM,
	FRST_REGISTER_ID,
	FRST_REGISTER_IP,
	LAST_UPDUSR_PNTTM,
	LAST_UPDUSR_ID,
	LAST_UPDUSR_IP,
	INS_PARENT_YN,
	INS_ALL_YN,
	INS_CB_YN,
	INS_HRD_YN,
	INS_LL_CD,
	INS_LOCAL_YN,
	INS_STATUS_CD,
	INS_FORM_DIV_CD,
	INS_FOUND_DIV_CD,
	NET_INFO,
	GIL_INS_CD,
	INS_LOCAL2_CD
)
VALUES (
	#[].insttCode#,
	#[].insttNm#,
	#[].insttDstrct#,
	#[].insttZip#,
	#[].insttAdres#,
	#[].insttAdresDetail#,
	#[].tel01#,
	#[].telAdit#,
	#[].fax01#,
	#[].faxAdit#,
	#[].dstrctCl#,
	#[].insLocalCd#,
	#[].chargerId#,
	#[].chargerNm#,
	#[].chargerEmail#,
	#[].confmAt#,
	#[].confmDe#,
	#[].confmId#,
	#[].elctrnSanctnId#,
	#[].insttRprsntvNm#,
	#[].gpsLa#,
	#[].gpsLo#,
	#[].useAt#,
	#[].deleteAt#,
	#[].insttLclas#,
	#[].insttMlsfc#,
	#[].insttSclas#,
	#[].frstRegisterPnttm#,
	#[].frstRegisterId#,
	#[].frstRegisterIp#,
	#[].lastUpdusrPnttm#,
	#[].lastUpdusrId#,
	#[].lastUpdusrIp#,
	#[].insParentYn#,
	#[].insAllYn#,
	#[].insCbYn#,
	#[].insHrdYn#,
	#[].insLlCd#,
	#[].insLocalYn#,
	#[].insStatusCd#,
	#[].insFormDivCd#,
	#[].insFoundDivCd#,
	#[].netInfo#,
	#[].gilInsCd#,
	#[].insLocal2Cd#
)
SELECT * FROM dual
</iterate>
</insert>

<select id="edcInsttMngrDAO.selectEdcInsttMngrListAll" resultMap="edcInsttMngrMap" parameterClass="edcinsttmngrvo">
	SELECT
		INSTT_CODE,
		INSTT_NM,
		INSTT_DSTRCT,
		INSTT_ZIP,
		INSTT_ADRES,
		INSTT_ADRES_DETAIL,
		TEL01,
		TEL_ADIT,
		FAX01,
		FAX_ADIT,
		DSTRCT_CL,
		INS_LOCAL_CD,
		CHARGER_ID,
		CHARGER_NM,
		CHARGER_EMAIL,
		CONFM_AT,
		CONFM_DE,
		CONFM_ID,
		ELCTRN_SANCTN_ID,
		INSTT_RPRSNTV_NM,
		GPS_LA,
		GPS_LO,
		OPNNG_DE,
		USE_AT,
		DELETE_AT,
		INSTT_LCLAS,
		INSTT_MLSFC,
		INSTT_SCLAS,
		FRST_REGISTER_PNTTM,
		FRST_REGISTER_ID,
		FRST_REGISTER_IP,
		LAST_UPDUSR_PNTTM,
		LAST_UPDUSR_ID,
		LAST_UPDUSR_IP,
		INS_PARENT_YN,
		INS_ALL_YN,
		INS_CB_YN,
		INS_HRD_YN,
		INS_LL_CD,
		INS_LOCAL_YN,
		INS_STATUS_CD,
		INS_FORM_DIV_CD,
		INS_FOUND_DIV_CD,
		NET_INFO,
		GIL_INS_CD,
		INS_LOCAL2_CD,
		WEB_URL,
		INSTT_GUIDANCE,
		IFNULL(SORT_NO, 1) AS SORT_NO,
		DEC_BEGIN_BNDE_SMS_YN,
		IFNULL(SITE_NUM, 0) AS SITE_NUM
	FROM TN_EDC_INSTT_MNGR
	<dynamic prepend="WHERE" >
	 		<isNotEmpty prepend="AND" property="searchInsttUnit" >
	 			<isNotEqual  property="searchInsttUnit" compareValue="ALL">
	 				INSTT_DSTRCT = #searchInsttUnit#
	 			</isNotEqual>
		</isNotEmpty>
	 		<isNotEmpty prepend="AND" property="searchInsttCode" >
	 			<isNotEqual  property="searchInsttCode" compareValue="ALL">
				INSTT_CODE = #searchInsttCode#
			</isNotEqual>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="searchInsttNm" >
			INSTT_NM LIKE <![CDATA['%]]>$searchInsttNm$<![CDATA[%']]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="searchInsttMlsfc" >
			INSTT_MLSFC = #searchInsttMlsfc#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="searchdstrctCl" >
			DSTRCT_CL = #searchdstrctCl#
	 		</isNotEmpty>
	 		<isNotEmpty prepend="AND" property="authUserId" >
			<!-- 조회 권한 설정 -->
	   		INSTT_CODE IN (SELECT INSTT_CODE FROM TN_RESVE_INSTT_AUTHOR WHERE USER_ID = #authUserId# AND USE_AT = 'Y' AND DELETE_AT ='N')
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="searchDeleteAt" >
			DELETE_AT = #searchDeleteAt#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="searchUseAt" >
			USE_AT = #searchUseAt#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="searchConfmAt" >
			CONFM_AT = #searchConfmAt#
		</isNotEmpty>
	</dynamic>
	ORDER BY SORT_NO, INSTT_NM
</select>



<select id="edcInsttMngrDAO.selectEdcInsttMngrMap" resultMap="edcInsttMngrHashMap" parameterClass="EdcInsttMngrVO">
	SELECT
		INSTT_CODE AS INSTT_CODE,
		INSTT_NM
	FROM
	TN_EDC_INSTT_MNGR
</select>

<select id="edcInsttMngrDAO.selectEdcInsttNm" resultClass="edcInsttMngr" parameterClass="edcInsttMngrVO">
	SELECT
				INSTT_CODE	AS insttCode
				, INSTT_NM		AS insttNm
	FROM
				TN_EDC_INSTT_MNGR
  WHERE
  				INSTT_CODE = #searchInsttCode#
</select>

<select id="edcInsttMngrDAO.selectInsttPayInfo" resultClass="edcInsttMngr" parameterClass="edcInsttMngrVO">
SELECT
            B.INSTT_CODE 	AS insttCode
            , B.INSTT_NM		AS insttNm
            , IFNULL(A.SITE_NUM, 0) AS siteNum
            , A.PG_CODE		AS pgCode
            , A.PG_KEY			AS pgKey
            , A.PG_IV		AS pgIv
            , A.PG_IV_KEY			AS pgIvKey            
            , A.MRHST_NM	AS mrhstNm
            , A.USE_AT			AS useAt
  FROM TN_CMMN_PAYINFO A, TN_EDC_INSTT_MNGR B
WHERE A.SITE_NUM = B.SITE_NUM
    AND B.INSTT_CODE = #searchInsttCode#
</select>



</sqlMap>